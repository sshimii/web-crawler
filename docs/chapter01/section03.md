# 1.3 爬虫基础

## 1.3.1 爬虫介绍

&emsp;&emsp;爬虫全称网络爬虫（web-crawler），是按照一定的规则自动化抓取万维网信息的程序或者脚本。它可以用多种程序语言来进行编写，并不局限于python
一种。你可能会以为爬虫离我们很遥远，其实爬虫离我们的生活很近，它已经深入我们的日常生活。百度搜索引擎可以说就是一个爬虫，它帮助我们在万维网上搜索出特定的信息。不过，我们这次的爬虫教程并不会教大家制作这个复杂的爬虫，但我们从小处入手，让大家学习爬虫的思路和方法，解决我们日常中的问题。复杂的问题，还是让大佬们去干吧！！！

## 1.3.2 爬虫的基本原理

&emsp;&emsp; 我们在上面已经提到，爬虫是按照一定的规则自动化抓取万维网信息的程序或者脚本。因此我们需要从爬取网页，解析数据，
存储数据下三个主要的方面来编写我们所用得爬虫程序。这些代码的实现听着可能会让你无从下手，但python语言有着众多的库，帮助我们来实现这些代码,
因此我们不必担心。如果你坚持学完本次课程，你会感到一些些简单。下面我将为大家介绍其中的原理和所用到的库。对于库的具体使用，我们会在后面的章节中具体地介绍。

- **爬取网页**

&emsp;&emsp;我们在编写一个爬虫程序时，我们需要考虑到如何获得网页的源代码。我们获得源代码后，我们便可以继续下一个步骤。我们在编写爬虫中，最大的困难来源于爬取网页的源代码，在以后的教程中，我们会着重讲述这部分内容。对于获取网页代码，python 库中有**urllib3**、**requests**、**httpx**库来帮助我们进行获取网页的源码。

- **解析数据**

&emsp;&emsp;当我们获得网页的源代码时，我们需要进行对网页源代码进行分析，用一定的工具去提取我们所需要的数据。我们可以使用正则表达式来帮助我们去提取数据，但正则有时并不能高效率地实现数据的提取。我们还需要借助其他的方法，如**Xpath**、**CSS选择器**，而 Python 中也已经有**lxml**库、**Beautiful Soup**库、**Parsel**
库助力我们去实现。

- **存储数据**

&emsp;&emsp;我们获得数据后，我们需要来存储我们所爬取的数据，以便我们以后的应用。比如，数据的可视化，数据的分析。对于数据，我们可以有多种保存形式。我们可以保存为 txt 文本、Json 文本、CSV 文本，也可以保存在数据库中，例如MYSQL、Mongodb，redis等。因此，在用python语言实现时，我们会用到**json**库、**csv**库、**pymysql**库、**pymongo**库、**redis**
库。以上库的具体使用将会在以下章节中具体介绍，在此处就不介绍了。

## 1.3.3 反爬的策略

&emsp;&emsp; 我们在爬虫的运行过程中，可能会遇到一些问题。如我们用爬虫程序访问不了网站、成功访问网站但拿不到我们想要的数据、爬取频率过快我们的IP
，登录时需要验证码等。这些都是网站为防止爬虫程序而设计的。

- **常见的反爬策略：**
    - User-Agent 检测
    - 账号以及 Cookie 验证
    - IP 访问限制
    - 验证码
    - JavaScript 动态渲染
    - Ajax 异步传输

&emsp;&emsp;上面是我们在简单网站中，常见的反爬策略。在实际中，我们还会遇到更加复杂的反爬策略，但我们不要灰心，多学习，多敲代码，我们还是可以突破这层防护的。

## 1.3.4 反反爬策略

&emsp;&emsp;
在上面，我们已经介绍了一些常见的反爬策略，那么接下来介绍的就是一些对应的反反爬策略。下面的反反爬策略跟上面的反爬是对应的。具体的代码实现我们将在后面的章节中实现。

- **反反爬策略：**
    - 进行User-Agent伪装
    - 手动登录获得 Cookie 再进行设置或者使用 **selenium**(后面会介绍)
    - 使用代理
    - 手动输入或者使用打码平台
    - 使用 Selenium 进行爬取
    - 使用浏览器自带的工具进行分析获得对应的 Ajax 请求

## 1.3.5 JavaScript动态渲染

&emsp;&emsp;在上面我们看到了反爬策略中有一个 JavaScript 动态渲染，看到那里，我们可能会疑惑JavaScript动态渲染是什么？为什么它会是一个反爬策略。下面让我们来往下阅读，阅读后你会得出一些答案。

&emsp;&emsp;在前端的发展过程中，起初是静态页面，但随着发展，这种页面逐渐减少。一静态页面交互性差。二是静态页面不能充分支持客户端/服务端的需求。三是静态页面反爬程度很低。因此，动态页面便出现在日常生活中。

&emsp;&emsp;有了动态页面，一些成为了可能。如Session和Cookie的设置，页面随着客户的动作而呈现和 Ajax 异步传输。因此，它也成为了一种反爬策略。试想下，我们正在爬取某个网站，而这个网站正是采用了 JavaScript 渲染的。我们访问时，只会加载一部分页面。只有我们滑动滚轮时，数据的页面才会继续加载出来。我们在写爬虫程序时，可不会让滚轮动起来，我们只能得到一部分的网页源代码。我们用爬虫得出来的代码就与页面的源码不一样。这也是为什么它成为一种反爬策略的方式。

&emsp;&emsp;对于上面的情形，我们便可以使用 Selenium 自动化工具，来实现这些动作，进而获得我们所需要的数据。对于 Selenium 的使用，我们在后面的章节中会学习到。

## 1.3.6 爬虫的法律

&emsp;&emsp;
不知道学习本课程的伙伴们有没有听过”爬虫学的好，牢饭吃的饱“这句话呢？我想大多数友友们还是知道的。我同样也是如此，我在看《python3网络爬虫开发实战》的时候，最先看的就是书本的最后一页，书的最后一页是作者给出的注意事项。毕竟，我也害怕爬了网站，进去了。下面将给出一些
爬虫禁区，这些还是很值得我们去了解的。

- 爬虫禁区
    - 为违法违规组织提供爬虫服务。
    - 个人隐私数据的抓取与贩卖
    - 利用无版权的商业数据获利
    - 目标爬虫因爬虫宕机造成严重的后果

&emsp;&emsp; 上面只介绍一点，还需要大家多多了解些法律，知道我们自己的底线是什么，我们才能更好地使用爬虫。

&emsp;&emsp; 最后，我想跟大家说，爬虫是一门技术，我们应该用度的观念看待它，学习它。希望伙伴们能在这次学习中，掌握爬虫的技术，正确运用爬虫的技术。

## 总结

&emsp;&emsp; 本小节中，我们学习了爬虫的基本原理，爬虫过程中遇到的反爬策略以及对应的反反爬策略，以及动态渲染。同时，我们也了解了编写爬虫过程需要的python库。最后我们了解了一些爬虫的禁区。

------
参考资料：

- 百度百科关于爬虫的介绍
- 《python3网络爬虫开发实战》
- [Crawler_Illegal_Cases_In_China](https://github.com/HiddenStrawberry/Crawler_Illegal_Cases_In_China)
- 百度百科关于静态页面的介绍。




